<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="description"
        content="Empowering Clinicians with MeDT: A Framework for Sepsis Treatment.">
  <meta name="keywords" content="MeDT">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Empowering Clinicians with MeDT: A Framework for Sepsis Treatment.</title>

  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-PYVRSFMDRL"></script>
  <script>
    window.dataLayer = window.dataLayer || [];

    function gtag() {
      dataLayer.push(arguments);
    }

    gtag('js', new Date());

    gtag('config', 'G-PYVRSFMDRL');
  </script>

  <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro"
        rel="stylesheet">

  <link rel="stylesheet" href="./static/css/bulma.min.css">
  <link rel="stylesheet" href="./static/css/bulma-carousel.min.css">
  <link rel="stylesheet" href="./static/css/bulma-slider.min.css">
  <link rel="stylesheet" href="./static/css/fontawesome.all.min.css">
  <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
  <link rel="stylesheet" href="./static/css/index.css">
  <link rel="icon" href="./static/images/favicon.svg">

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script defer src="./static/js/fontawesome.all.min.js"></script>
  <script src="./static/js/bulma-carousel.min.js"></script>
  <script src="./static/js/bulma-slider.min.js"></script>
  <script src="./static/js/index.js"></script>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width">
  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script id="MathJax-script" async
          src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
  </script>
</head>
<body>

<nav class="navbar" role="navigation" aria-label="main navigation">
  <div class="navbar-brand">
    <a role="button" class="navbar-burger" aria-label="menu" aria-expanded="false">
      <span aria-hidden="true"></span>
      <span aria-hidden="true"></span>
      <span aria-hidden="true"></span>
    </a>
  </div>
  <div class="navbar-menu">
    <div class="navbar-start" style="flex-grow: 1; justify-content: center;">
      <a class="navbar-item" href="https://aamer98.github.io">
      <span class="icon">
          <i class="fas fa-home"></i>
      </span>
      </a>


    </div>

  </div>
</nav>


<section class="hero">
  <div class="hero-body">
    <div class="container is-max-desktop">
      <div class="columns is-centered">
        <div class="column has-text-centered">
          <h1 class="title is-1 publication-title">Empowering Clinicians with MeDT: A Framework for Sepsis Treatment</h1>
          <div class="is-size-5 publication-authors">
            <span class="author-block">
              <a href="https://aamer98.github.io/">Aamer Abdul Rahman</a><sup>1,3</sup>,</span>
            <span class="author-block">
              <a href="https://pranaval.github.io/">Pranav Agarwal</a><sup>1,3</sup>,</span>
            <span class="author-block">
              <a href="https://vmichals.github.io/">Vincent Michalski</a><sup>1,2</sup>,
            </span>
            <span class="author-block">
              <a href="https://www.etsmtl.ca/en/research/professors/rnoumeir/">Rita Noumeir</a><sup>3</sup>,
            </span>
            <span class="author-block">
              <a href="https://recherche.umontreal.ca/english/our-researchers/professors-directory/researcher/is/in15318/">Philippe Jouvet</a><sup>4</sup>,
            </span>
            <span class="author-block">
              <a href="https://saebrahimi.github.io/">Samira Ebrahimi Kahou</a><sup>1,3,5</sup>
            </span>
          </div>

          <div class="is-size-5 publication-authors">
            <span class="author-block"><sup>1</sup>Mila</span>
            <span class="author-block"><sup>2</sup>Université de Montréal</span>
            <span class="author-block"><sup>3</sup>École de Technologie Supérieure</span>
            <span class="author-block"><sup>4</sup>CHU Sainte-Justine</span>
            <span class="author-block"><sup>5</sup>CIFAR</span>
          </div>

          <div class="column has-text-centered">
            <div class="publication-links">
              <!-- PDF Link. -->
              <span class="link-block">
                <a href="https://aamer98.github.io/medical_decision_transformer/"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fas fa-file-pdf"></i>
                  </span>
                  <span>Paper</span>
                </a>
              </span>
              <span class="link-block">
                <a href="https://aamer98.github.io/medical_decision_transformer/"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="ai ai-arxiv"></i>
                  </span>
                  <span>arXiv</span>
                </a>
              </span>
              <!-- Code Link. -->
              <span class="link-block">
                <a href="https://github.com/Aamer98/MeDT"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fab fa-github"></i>
                  </span>
                  <span>Code</span>
                  </a>
              </span>
            </div>

          </div>
        </div>
      </div>
    </div>
  </div>
</section>



<section class="hero is-light is-small">
  <div class="hero-body">
    <div class="container">
        <div class="content has-text-centered">
          <img src="static\images\meDT_eval.png" alt="MeDT" width="600">
        </div>
        <h4 class="subtitle has-text-centered">
          Architecture and pipeline of MeDT.
        </h4>
    </div>
  </div>
</section>


<section class="section">
  <div class="container is-max-desktop">
    <!-- Abstract. -->
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Abstract</h2>
        <div class="content has-text-justified">
          
          
          <p>
            Offline reinforcement learning has shown promise for solving tasks in safety-critical settings, 
            such as clinical decision support. Its application, however, has been limited by the need for 
            interpretability and interactivity for clinicians.
          </p>
          <p>
            To address these challenges, we propose medical decision transformer (MeDT), a novel and versatile 
            framework based on the goal-conditioned RL paradigm for sepsis treatment recommendation. MeDT is 
            based on the decision transformer architecture, and conditions the model on expected treatment 
            outcomes, hindsight patient acuity scores, past dosages and the patient's current and past medical 
            state at every timestep.
          </p>
          <p>
            This allows it to consider the complete context of a patient's medical history, enabling more informed 
            decision-making. By conditioning the policy's generation of actions on user-specified goals at every 
            timestep, MeDT enables clinician interactability while avoiding the problem of sparse rewards. 
            Using data from the MIMIC-III dataset, we show that MeDT produces interventions that outperform 
            or are competitive with existing methods while enabling a more interpretable, personalized and 
            clinician-directed approach.
          </p>
        </div>
      </div>
    </div>
    <!--/ Abstract. -->

  </div>
</section>


<section class="section">
  <div class="container is-max-desktop">


    <!-- Motivation. -->
    <div class="columns is-centered">
      <div class="column is-full-width">
        <h2 class="title is-3">Motivation</h2>

        <div class="content has-text-justified">
          <p>
            Recent research in RL is shifting towards attention-based networks like transformers 
            which counter many challenges of RNNs. Chen et al. proposed the Decision Transformer (DT), 
            a transformer based RL policy learning model that has proven effective for offline RL. DT 
            addresses the problem of sparse or distracting rewards by leveraging self-attention for credit 
            assignment, which incorporates contextual information into the learning process.  Furthermore, 
            the transformer's ability to model long sequences enables it to consider the patient's history 
            of states and medications to make predictions. 
          </p>
          <p>Building on this idea, we propose an offline RL framework where treatment dosage recommendation 
            is framed as a sequence modeling problem. The proposed framework called the 
            Medical Decision Transformer (MeDT), is based on the DT architecture and recommends optimal 
            treatment dosages by autoregressively modeling a patient's state while conditioning on hindsight 
            return information. To provide the policy with more informative and goal-directed input, we also 
            condition MeDT on hindsight patient acuity scores at every time step. This enhances interpretability 
            of the conditioning facilitating interaction of clinicians with the model.
            </p>
        </div>

        <br/>

        <!-- MeDT. -->
        <h2 class="title is-3">Medical Decision Transformer</h2>
        <div class="content has-text-justified">
          <p>
            We model our trajectories such that the transformer 
            conditions on future desired returns to generate treatment dosages. Specifically, we use 
            returns-to-go \[r_t=\sum_{t^{\prime}=t}^T R_{t^{\prime}},\]which represents patient death or 
            survival status, to condition the model. In addition, we propose to condition MeDT 
            on future patient acuity scores (SAPS2), or acuity-to-go, where the acuity score provides an 
            indication of the severity of illness of the patient in the ICU, based on the status of the 
            patient's physiological systems. This leads to 
            more information-dense conditioning, allowing clinicians to interact with the model and 
            guide the policy's generation of treatment dosages.
          </p>
          <p>The acuity scores are split to represent different physiological systems, defined as 
            \[k = (k_c, k_r, k_n, k_l, k_h, k_m, k_o)\] which represent the status of the cardiovascular, 
            respiratory, neurological, renal, hepatic, haematologic and other systems, respectively. 
            This enhances the usability of the model for clinicians, enabling efficient interaction with the 
            model for future dosage recommendations, considering the current state of the patient's organs.
            Using these scores, the treatment progress over T time steps forms a trajectory
            \[
            \tau=\left((r_1, k_1, s_1, a_1), (r_2, k_2, s_2, a_2), \ldots, (r_T, k_T, s_T, a_T)\right)\].
          </p>
        </div>

        <br/>

        <!-- Evaluation. -->
        <h2 class="title is-3">Policy Evaluation</h2>
        <div class="content has-text-justified">
          <p>
            In online RL, policies are assessed by having them interact with the environment. However, 
            healthcare involves patients, where employing this evaluation method is unsafe. As a stand-in for 
            the simulator during inference, we propose to additionally learn an approximate model 
            (state predictor) of \[P_{\theta}(s_{t}|a_{< t},s_{< t})\] with a similar architecture as the policy 
            model. During inference, this model allows autoregressive generation of a sequence of actions by 
            predicting how the patient state evolves as a result of those actions. The following algorithm 
            details this rollout procedure
          </p>
          <h2 class="title is-4">Algorithm</h2>
          <img src="static\images\alg.png" alt="Italian Trulli">

                
        <div class="content has-text-centered">
        </div>

        <br/>

        <!-- Results. -->
        <h2 class="title is-3">Results</h2>
        <div class="content has-text-justified">



        <!-- Re-rendering. -->
        <h3 class="title is-4">Dosage Distribution</h3>
        <div class="content has-text-justified">
          <p>
            The learnt MeDT policy learns to recommend dosages similar to that of clinicians.
          </p>
        </div>
        <div class="content has-text-centered">
          <img src="static\images\clinVmedt.png" alt="Dosage Distribution">
        </div>
        <!--/ Re-rendering. -->

        <!-- Re-rendering. -->
        <h3 class="title is-4">Patient Outcomes</h3>
        <div class="content has-text-justified">
          <p>
            Dosages output by MeDT lead to better estimated outcomes than baselines.
          </p>
        </div>
        <div class="content has-text-centered">
          <img src="static\images\saps_table.png" alt="SAPS Scores", width="500">
        </div>
        <!--/ Re-rendering. -->

        <!-- Re-rendering. -->
        <h3 class="title is-4">Effect of Intervention</h3>
        <div class="content has-text-justified">
          <p>
            MeDT leads to more stable patient rollouts than DT.
          </p>
        </div>
        <div class="content has-text-centered">
          <img src="static\images\patient_trajectories.png" alt="Patient Trajectories">
        </div>
        <!--/ Re-rendering. -->        

      </div>
    </div>
    <!--/ Animation. -->



  </div>
</section>


<section class="section" id="BibTeX">
  <div class="container is-max-desktop content">
    <h2 class="title">BibTeX</h2>
    <pre><code>@inproceedings{rahman2023empowering,
    title={Empowering Clinicians with Me{DT}: A Framework for Sepsis Treatment},
    author={Abdul Rahman, Aamer and Agarwal, Pranav and Michalski, Vincent and Noumeir, Rita and Jouvet, Philippe and 
      Ebrahimi Kahou, Samira},
    booktitle={NeurIPS 2023 Workshop on Goal-Conditioned Reinforcement Learning},
    year={2023}
    }
</code></pre>
  </div>
</section>


<footer class="footer">
  <div class="container">
    <div class="columns is-centered">
      <div class="column is-8">
        <div class="content">
          <div class="content has-text-centered">
          <p>
            Website template is borrowed from <a rel="license"
            href="https://github.com/nerfies/nerfies.github.io">Nerfies</a>.
          </p>
          </div>
        </div>
      </div>
    </div>
  </div>
</footer>

</body>
</html>
